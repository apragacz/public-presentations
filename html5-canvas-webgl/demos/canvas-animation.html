<!doctype html>
<html>
    <head>
        <title>Canvas Animation Demo</title>
        <meta charset="UTF-8" />
        <meta name="author" content="Andrzej Pragacz" />
    </head>
    <body>
        <canvas id="canvas" width="800" height="600"></canvas>
        <script type="text/javascript" src="js/lib/jquery-1.8.1.min.js"></script>
        <script type="text/javascript" src="js/base.js"></script>
        <script type="text/javascript" src="js/canvas/sprites.js"></script>
        <script type="text/javascript" src="js/canvas/engine.js"></script>
        <script type="text/javascript">
            $(function () {
                var canvas = document.getElementById("canvas");
                var image1 = new Image();
                var image2 = new Image();
                var imagesToLoad = 2;

                var getRandomX = function () {
                    return Math.round(50 + Math.random() * (canvas.width - 100));
                };

                var getRandomY = function () {
                    return Math.round(50 + Math.random() * (canvas.height - 100));
                };

                var fireUpEngine = function () {
                    var canvasEngine = new CanvasEngine({
                        canvas: canvas
                    });

                    for (var i = 0; i < 2; i++) {
                        var x = getRandomX();
                        var y = getRandomY();
                        var sprite = new ImageMovableSprite({
                            x: x,
                            y: y,
                            xUpdate: 1,
                            yUpdate: 2,
                            scale: 0.2,
                            rotUpdate: 0.01,
                            image: image1
                        });
                        canvasEngine.addSprite(sprite);
                    }
                    for (var i = 0; i < 2; i++) {
                        var x = getRandomX();
                        var y = getRandomY();
                        var sprite = new ImageMovableSprite({
                            x: x,
                            y: y,
                            xUpdate: 1,
                            yUpdate: 2,
                            rotUpdate: 0.03,
                            alpha: 0.5,
                            image: image2
                        });
                        canvasEngine.addSprite(sprite);
                    }
                    for (var i = 0; i < 5; i++) {
                        var x = getRandomX();
                        var y = getRandomY();
                        var sprite = new NGonMovableSprite({
                            x: x,
                            y: y,
                            xUpdate: 1,
                            yUpdate: 3,
                            fillColor: 'rgba(255,0,0, 0.8)',
                            rotUpdate: 0.01,
                            size: 40,
                            sides: 8
                        });
                        canvasEngine.addSprite(sprite);
                    }
                    for (var i = 0; i < 5; i++) {
                        var x = getRandomX();
                        var y = getRandomY();
                        var sprite = new NGonMovableSprite({
                            x: x,
                            y: y,
                            xUpdate: 2,
                            yUpdate: 1,
                            fillColor: 'rgba(0,0,255, 0.8)',
                            rotUpdate: 0.01,
                            size: 40,
                            sides: 5
                        });
                        canvasEngine.addSprite(sprite);
                    }
                    for (var i = 0; i < 2; i++) {
                        var x = getRandomX();
                        var y = getRandomY();
                        var sprite = new NGonMovableSprite({
                            x: x,
                            y: y,
                            xUpdate: -5,
                            yUpdate: 1,
                            stroke: true,
                            fillColor: 'rgba(0,0,255, 0.8)',
                            rotUpdate: 0.01,
                            size: 40,
                            sides: 5
                        });
                        canvasEngine.addSprite(sprite);
                    }

                    for (var i = 0; i < 2; i++) {
                        var x = getRandomX();
                        var y = getRandomY();
                        var sprite = new NGonMovableSprite({
                            x: x,
                            y: y,
                            xUpdate: -4,
                            yUpdate: 2,
                            rotUpdate: 0.001,
                            fillColor: 'rgba(0,255,0, 0.8)',
                            shadow: true,
                            size: 40,
                            sides: 3
                        });
                        canvasEngine.addSprite(sprite);
                    }

                    canvasEngine.start();
                };

                var onLoadImage = function () {
                    imagesToLoad--;
                    if (imagesToLoad <= 0) {
                        fireUpEngine();
                    }
                };
                image1.onload = onLoadImage;
                image2.onload = onLoadImage;
                image1.src = 'img/megusta.png';
                image2.src = 'img/megusta-small.png';
            });


        </script>

    </body>
</html>
